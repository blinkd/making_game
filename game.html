<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<title>game 1</title>
    <style media="screen">
        canvas {
            border: 1px black solid;
        }

    </style>
</head>
<body>
	<canvas id = 'id-canvas' width='400' height='300'></canvas>

	<script>

	// 第一部分

  var imageFromPath = function(path){
		var img = new Image()
		img.src = path
		return	img
	}

 //为何不需要
	// log(img)
	// img.onload = function(){
	// 	context.drawImage(img, x, y)
	// }


// paddle 的逻辑应该放在paddle对象里去操作 其实例
	var Paddle = function(){
		var img = imageFromPath('paddle.png')
		var o = {
			image:img,
			x:100,
			y:250,
			speed:10,
		}
		o.moveLeft = function(){
			o.x -= o.speed
		}

		o.moveRight = function(){
			o.x += o.speed
		}
		return o
	}


	var Game = function(){
		var g = {}

		var canvas = document.querySelector('#id-canvas')
		var context = canvas.getContext('2d')

		g.canvas = canvas
		g.context = context

		setInterval (function(){
			//updata
			g.update()
			//clear\
			context.clearRect(0, 0, canvas.width, canvas.height)
			//draw
			g.draw()
		}, 1000/30)

		return g
	}

	var __main = function () {

		var log = console.log.bind(console)


		var paddle = Paddle()
		var game = Game()


		var leftDown = false
		var rightDown = false

		//events
		window.addEventListener('keydown', function(event){
			log('keydown')
			var k = event.key
			if (k == 'a'){
				leftDown = true
			}else if(k == 'd'){
				rightDown = true
			}

		})

		window.addEventListener('keyup', function(event){
			log('keyup')
			var k = event.key
			if (k == 'a'){
				leftDown = false
			}else if(k == 'd'){
				rightDown = false
			}

		})

		game.update = function(){
			if (leftDown){
				// paddle.x -= paddle.speed
				paddle.moveLeft()
			}else if(rightDown){
				paddle.moveRight()
				// paddle.x += paddle.speed
			}
		}

		game.draw = function(){
				game.context.drawImage(paddle.image, paddle.x, paddle.y)
		}

		// setInterval(function(){
		//
		// 	log(paddle)
		//
		// }, 1000/30)

	}

	__main()

	</script>
</body>
</html>
